function phoneValidation(){}function emailValidation(){}function fullYear(e,a,t){if(/^\d{2}\.\d{2}\.\d{4}$/.test(e)){var n=e.match(/^\d{2}/)[0],s=e.match(/\.\d{2}\./)[0].replace(/\./g,"")-1,o=e.match(/\d{4}$/)[0],i=new Date;return a&&i.setDate(i.getDate()+a),t&&t>0&&i.setMonth(i.getMonth()+parseInt(t)),new Date(o,s,n)?i.getFullYear()-o-((i.getMonth()-s||i.getDate()-n)<0):(console.log("Не существует такой даты!"),!1)}return console.log("Ошибка дата не в том формате!"),!1}function dateDistYear(e,a){if(/^\d{2}\.\d{2}\.\d{4}$/.test(e)&&/^\d{2}\.\d{2}\.\d{4}$/.test(a)){var t=e.match(/^\d{2}/)[0],n=e.match(/\.\d{2}\./)[0].replace(/\./g,"")-1,s=e.match(/\d{4}$/)[0],o=a.match(/^\d{2}/)[0],i=a.match(/\.\d{2}\./)[0].replace(/\./g,"")-1,r=a.match(/\d{4}$/)[0];return new Date(s,n,t)&&new Date(r,i,o)?r-s-((i-n||o-o)<0):(console.log("Не существует такой даты!"),!1)}return console.log("Ошибка дата не в том формате!"),!1}function isChildren(e){if(fullYear(e)<=17)return!0}function havePassport(e){if(fullYear(e)>=14)return!0}function passportCheck(e,a){var t=e,n=a,s=fullYear(t),o=dateDistYear(t,n);return 0!=checkMaxDate(dataFormat(e))&&0!=checkMaxDate(dataFormat(a))&&(!(s>=14&&s<=20&&(o<14||o>20))&&(!(s>=20&&s<=45&&(o<20||o>45))&&!(s>=45&&o<45)))}var preloader='<div class="preloader" data-loader="circle-side"></div>';$(document).ready((function(){$(".more-info").click((function(e){e.preventDefault(),$(this).toggleClass("active"),$(".more-info-block").slideToggle(300)})),$(".auth-modal").addClass("visible"),$(".close_msg").click((function(){$(".messege-block").slideUp(200)})),$(".show-spravka").click((function(e){e.preventDefault(),showPopup({title:"Справка о доходах",text:'<div class="files-block">\n                    <a href="/files/2-ndfl.pdf" target="_blank" class="file-ico">2 НДФЛ</a>\n                    <a href="/files/gosuslugi.pdf" target="_blank" class="file-ico">Справка Госуслуги</a>\n                    <a href="/files/faq.pdf" target="_blank" class="file-ico">Инструкция</a>\n                    <a href="/files/free_form.pdf" target="_blank" class="file-ico">Наша форма</a>\n                    <a href="/files/samozan.pdf" target="_blank" class="file-ico">Самозанятые</a></div>'})}))}));var api="https://c2b.aptnn.ru";function showAspModal(e,a,t){2!=a?($("#asp1-modal a").attr("href",e),$("#asp1 .client-phone").text(t),$("#confirm-phone .client-phone").text(t),$(".asp1, .confirm-phone").hide(),$("#asp1-modal").slideDown(200),$("body").addClass("modal-open"),aspInit(e)):($("#asp2 .client-phone").text(t),$("#asp2-modal").slideDown(200),asp2Init(e),$("#asp2-modal a").attr("href",e))}function aspInit(e){$.ajax({type:"POST",url:"asptransport/sendSms?"+(new Date).getTime(),data:{id_app:e},beforeSend:function(){$("#asp1-modal .title").after('<div class="loading" data-loader="circle-side"></div>')},success:function(a){$("#asp1-modal .loading").remove();var t=$.parseJSON(a);console.log(t),$("#asp1 input[name=id_app]").val(e),$("#asp1 .docs-lines").html(buildListAsp(t,e)),$(".asp1").slideDown(200),$("#asp1-modal .goback").show(),$(".sign-type-select").slideUp(200),$(".client-phone")},error:function(e,a){return showPopup({text:"Возникла ошибка: "+e.responseText}),!1}})}function phoneConfirm(e,a){$.ajax({type:"POST",url:"asptransport/sendSms?"+(new Date).getTime(),data:{id_app:e,type:a},beforeSend:function(){},success:function(e){var a=$.parseJSON(e);console.log(a)},error:function(e,a){return showPopup({text:"Возникла ошибка: "+e.responseText}),!1}})}function asp2Init(e){$.ajax({type:"GET",url:api+"/api/v1/signDocs?"+(new Date).getTime(),data:{uuid:e},beforeSend:function(){$(".asp2").removeClass("no-asp").hide(),$("#asp2-modal .title").after('<div class="loading" data-loader="circle-side"></div>')},success:function(a){var t=a;t.sms_no_send&&$(".asp2").addClass("no-asp"),$("#asp2-modal .loading").remove(),$(".asp2").slideDown(200),console.log(t),$("#asp2 input[name=id_app]").val(e),$("#asp2 .docs-wrapper").html(buildListAsp2(t.type,e)),$("body").addClass("modal-open")},error:function(e,a){return showPopup({text:"Возникла ошибка: "+e.responseText}),!1}})}function confirmPhoneInit(e,a){$(".continue-timeout").hide(),$("#confirm-phone input[name=id_app]").val(e),$(".asp1").slideUp(200),$(".confirm-phone .docs-lines").html('<div class="doc-line"><a href="#" data-type="checkPhone" class="get-pdf">Код подтверждения: </a><input name="checkPhone" type="text" maxlength="4"></div>'),$(".confirm-phone").slideDown(200),setTimeout((function(){$(".continue-timeout").show(200)}),3e4),phoneConfirm(e,a)}function buildListAsp(e,a){console.log(e);var t="",n=!1;return $.each(e,(function(e,s){var o;switch(s.type){case"Lsp_PD":o="LSP";break;case"bkr":o="BKR";break;case"bki":o="OPD";break;case"cancelApp":o="Код подтверждения",n=!0;break;default:o=s.type}"LSP"==o?t='<div class="doc-line sms-code"><a href="'+a+'" data-type="'+s.type+'" class="get-pdf">'+o+':</a><input type="text" name="'+s.type+'" maxlength="4"></div>'+t:t+='<div class="doc-line sms-code"><a href="'+a+'" data-type="'+s.type+'" class="get-pdf">'+o+':</a><input type="text" name="'+s.type+'" maxlength="4"></div>'})),n||(t+='<div class="doc-line"><span>ID:</span><input type="text" data-jur="МКК" name="code" maxlength="5"></div>'),t}function buildListAsp2(e,a){var t="",n="",s="";return $.each(e,(function(e,o){var i,r;switch(o){case"sms_mkk":i="SMS",r="МКК";break;case"rat_mkk":i="RAT",r="МКК";break;case"iugp_mkk":i="IGP",r="МКК";break;case"pnp_mkk":i="PNP",r="МКК";break;case"ins_mkk":i="INS",r="МКК";break;case"app_mkk":i="ZNZ",r="МКК";break;case"app_agk":i="AAP",r="АГК";break;case"asp_pd_agk":i="TCA",r="АГК";break;case"asp_pd_kag":i="TCK",r="КАГ";break;case"contract_kag":i="KCT",r="КАГ";break;default:i=o.type}"МКК"==r&&(t+='<div class="doc-line sms-code"><a href="'+a+'" data-type="'+o+'" class="get-pdf">'+i+':</a><input type="text" name="'+o+'" maxlength="4"></div>'),"АГК"==r&&(n+='<div class="doc-line sms-code"><a href="'+a+'" data-type="'+o+'" class="get-pdf">'+i+':</a><input type="text" name="'+o+'" maxlength="4"></div>'),"КАГ"==r&&(s+='<div class="doc-line sms-code"><a href="'+a+'" data-type="'+o+'" class="get-pdf">'+i+':</a><input type="text" name="'+o+'" maxlength="4"></div>')})),""!=t&&(t='<div class="docs-title">Документы МКК:</div><div class="docs-lines" id="docs_mkk">'+(t+='<div class="doc-line id-line"><span>ID:</span><input data-jur="МКК" type="text" name="code" maxlength="6"></div>')+"</div>"),""!=n&&(n='<div class="docs-title">Документы АГК:</div><div class="docs-lines" id="docs_mkk">'+(n+='<div class="doc-line id-line"><span>ID:</span><input data-jur="АГК" type="text" name="code" maxlength="6"></div>')+"</div>"),""!=s&&(s='<div class="docs-title">Документы БАВ:</div><div class="docs-lines" id="docs_mkk">'+(s+='<div class="doc-line id-line"><span>ID:</span><input data-jur="БАВ" type="text" name="code" maxlength="6"></div>')+"</div>"),n+s+t}function checkAspFields(e){var a=0,t=0;return e.find(".docs-lines .sms-code input").each((function(){t++,4==$(this).val().length&&a++})),console.log(a,t),a==t&&0!=a}function createArrayCodes(e){var a=[];return e.find("input[type=text]").each((function(){var e={},t=$(this).attr("name"),n=$(this).val();"code"!=t&&((e={})[t]=n,a.push(e))})),a}function checkAspCodes(e,a){var t=e.find("input[name=id_app]").val(),n=JSON.stringify(createArrayCodes(e)),s=api+"/api/v1/checkSignByCodes?"+(new Date).getTime();s="asp1"==e.attr("id")?api+"/api/v1/checkSignByCodes?"+(new Date).getTime():api+"/api/v1/checkSignContract?"+(new Date).getTime(),$.ajax({type:"POST",url:s,data:{uuid:t,codes:n},beforeSend:function(){e.find("button").addClass("disabled").text("Ожидайте")},success:function(a){e.find("button").removeClass("disabled").text("Подписать");var t=a;if(1==t.error)showPopup({text:t.error_msg});else if(1==t.success)t.link?window.location.href=t.link:location.reload();else{var n=0;$.each(t,(function(a,t){(t.error||3!=t.status)&&(addClassValid(e.find("input[name="+a+"]"),!1),n++)})),n>0&&showPopup({text:"Неверный код подтверждения."})}},error:function(a,t){return e.find("button").removeClass("disabled").text("Подписать"),showPopup({text:"Возникла ошибка: "+a.responseText}),!1}})}function checkConfirmCodes(e){var a=e.find("input[name=id_app]").val(),t=[],n=!1;e.find("input[type=text]").each((function(){var e={},a=$(this).attr("name"),s=$(this).val();n=!!$(this).hasClass("disabled"),"code"!=a&&(e={type:a,code:s}),t.push(e)})),console.log(t),$.ajax({type:"POST",url:api+"/api/v1/checkSignByCodes?"+(new Date).getTime(),data:{uuid:a,data:t},beforeSend:function(){e.find("button").addClass("disabled").text("Ожидайте")},success:function(t){e.find("button").removeClass("disabled").text("Подписать");var s=$.parseJSON(t);if(1==s.error)showPopup({text:s.error_msg});else{var o=0;$.each(s,(function(a,t){t.error||3!=t.status?(addClassValid(e.find("input[name="+a+"]"),!1),o++):addClassValid(e.find("input[name="+a+"]"),!0)})),o>0&&!n?showPopup({text:"Неверный код подтверждения."}):AspFree(a)}},error:function(a,t){return e.find("button").removeClass("disabled").text("Подписать"),showPopup({text:"Возникла ошибка: "+a.responseText}),!1}})}function getCodesById(e,a,t,n){$.ajax({type:"POST",url:api+"/api/v1/checkSignByProtect?"+(new Date).getTime(),data:{uuid:e,id:a},beforeSend:function(){},success:function(e){var a=e;$.each(a,(function(e,a){$("input[name="+a.type+"]").val(a.code).trigger("input")})),checkAspFields(n)},error:function(e,a){return showPopup({text:"Возникла ошибка: "+e.responseText}),!1}})}function signByHand(e){$.ajax({type:"POST",url:"main/heandWrite?"+(new Date).getTime(),data:{id_app:e},beforeSend:function(){},success:function(e){1==$.parseJSON(e).succes?showPopup({title:"",text:"Договор подписан вручную.",links:[{link_text:"OK",link_class:"reloadapp",link:"/"}]}):showPopup({title:"",text:"Произошла ошибка пробробуйте еще раз."})},error:function(e,a){return showPopup({text:"Возникла ошибка: "+e.responseText}),!1}})}function AspFree(e){$.ajax({type:"POST",url:"main/writeApp1etap?"+(new Date).getTime(),data:{id_app:e},beforeSend:function(){},success:function(e){1==$.parseJSON(e).succes?showPopup({title:"",text:"Заявка подписана вручную.",links:[{link_text:"OK",link_class:"reloadapp",link:"/"}]}):showPopup({title:"",text:"Произошла ошибка пробробуйте еще раз."})},error:function(e,a){return showPopup({text:"Возникла ошибка: "+e.responseText}),!1}})}$(document).on("click","#asp1 .default-sign-type",(function(e){e.preventDefault();var a=$(this).attr("data-type");confirmPhoneInit($(this).attr("href"),a)})),$(document).on("input",".docs-lines .sms-code input",(function(){$(this).removeClass("notValid");var e=$(this).parent().parent().parent().parent();checkAspFields(e)?e.find("button").prop("disabled",!1).removeClass("disabled"):e.find("button").prop("disabled",!0).addClass("disabled")})),$(document).on("input","input[name=code]",(function(){var e=$(this).val(),a=$(this).parent().parent().parent().parent(),t=a.find("input[name=id_app]").val(),n=$(this).attr("data-jur");5==e.length&&getCodesById(t,e,n,a)})),$(document).on("input","input[name=checkPhone]",(function(){var e=$(this).val();$(this).parent().parent().parent().find("input[name=id_app]").val();5==e.length?$("#confirm-phone button").prop("disabled",!1).removeClass("disabled"):$("#confirm-phone button").prop("disabled",!0).addClass("disabled")})),$(document).on("submit","#asp1, #asp2",(function(e){e.preventDefault(),checkAspCodes($(this))})),$(document).on("submit","#confirm-phone",(function(e){e.preventDefault();$(this).find("input[name=id_app]").val();checkConfirmCodes($(this))})),$(document).on("click",".continue-timeout",(function(e){e.preventDefault(),$(".confirm-phone .doc-line").addClass("d-none"),$(".confirm-phone .doc-line input").prop("disabled",!0).addClass("disabled").val(""),$("#confirm-phone button").prop("disabled",!1).removeClass("disabled")})),$(document).on("click",".sign-contact-by-hand",(function(e){e.preventDefault(),signByHand($(this).attr("href"))})),$("#noAspLink").click((function(e){e.preventDefault(),$(".no-asp-block").slideToggle(200)}));var dadata_token="0000000000000000000000000000000000";function mainCalc(e){var a=parseFloat($("input[name=summ]").val());a=a||0;var t,n,s,o=$("input[name=partner_installment]").prop("checked"),i=0,r=$("#discount").val(),l=parseFloat($("[name=summ_sured]").val()),p=e||$("#margin").val(),c=parseFloat($("select[name=avans]").val()),d=$("select[name=months]").val(),u=$("input[name=proc2client]").val(),m=p/100+1,_=$("#partner_discount").val(),h=$("#partner_discount_temp").val(),f=$("#isPreferentialProgramm").val()>0,v=c&&0!=c?parseFloat((a*c/100).toFixed(2)):0;$("#avans_to_partner").attr("readonly")||(v=$("#avans_to_partner").val());var g,k=$("#sms_inform").prop("checked")?parseFloat($("#sms_inform").attr("data-price")):0;$("#sms_summ").val(k);var b=parseFloat((l*m).toFixed(2));parseFloat((b-l).toFixed(2));if(0==o||f){if(0!=_?$("#partner_discount_pre").show().find("span").text(parseFloat(_).toFixed(2)+"%"):$("#partner_discount_pre").hide(),$("input[name=partner_discount_temp").val(_),g=a*(1-r/100).toFixed(2)-v,i=0==d?0:parseFloat((g/100*(d*insCalc())).toFixed(2)),_>0&&o)g-=a/100*_;$("input[name=summa_zaim_for_validate").val(g),g+=i,g+=parseFloat(k),g+=parseFloat(l),t=parseFloat(((g-l)*m).toFixed(2))+b,s=0==d?0:(t/d*100).toFixed(2)/100,n=(100*(t-g-a*r/100)).toFixed(2)/100}else{t=(100*(a*(1+u*d)-v)).toFixed(2)/100;var y=parseFloat((t/m).toFixed(2));0!=insCalc()&&(i=0==d?0:parseFloat((y/100*(d*insCalc())).toFixed(2))),$("input[name=summa_zaim_for_validate").val(y),g=y+i,h=(((a-v-y)/a*1e4).toFixed(2)/100).toFixed(2),g+=parseFloat(l),g+=parseFloat(k),t=parseFloat(((g-l)*m).toFixed(2)),n=(n=(100*((t+=b)-g-a*h/100)).toFixed(2)/100)<0?0:n,s=0==d?0:(t/d*100).toFixed(2)/100,console.log(h),0!=h?$("#partner_discount_pre").show().find("span").text(parseFloat(h).toFixed(2)+"%"):$("#partner_discount_pre").hide(),$("input[name=partner_discount").val(h)}$("[name=monthly_installment]").val(Math.round(s)),$("input[name=summa_zaim]").val(Math.round(g)),$("input[name=overpayment]").val(Math.round(n)),$("input[name=summa_dogovor]").val(Math.round(t)),$("input[name=avans_to_partner").val(Math.round(v)),$("#googs_pre span").text((a+" руб.").replace(/^\s*(\d+)(\d{3})\s*([а-я\.]+)?\s*$/,"$1 $2 $3")),0!=v?$("#avans_pre").show().find("span").text((Math.round(v)+" руб.").replace(/^\s*(\d+)(\d{3})\s*([а-я\.]+)?\s*$/,"$1 $2 $3")):$("#avans_pre").hide(),$("#summ_pre span").text((Math.round(g)+" руб.").replace(/^\s*(\d+)(\d{3})\s*([а-я\.]+)?\s*$/,"$1 $2 $3")),$("#monthly_installment_pre span").text((Math.round(s)+" руб.").replace(/^\s*(\d+)(\d{3})\s*([а-я\.]+)?\s*$/,"$1 $2 $3")),$("#partner_prem_pre span").text((calc_partner_rewards().toFixed(2)+" руб.").replace(/^\s*(\d+)(\d{3})\s*([а-я\.]+)?\s*$/,"$1 $2 $3")),lgotniyCalc($("select[name=programm] option:selected").text(),a,v),0==o&&$("#partner_discount_pre").hide(),recalc(),checkLimitSumm($("input[name=summa_zaim"))}function insCalc(){var e=$("[name=InsLife]").is(":checked"),a=$("[name=InsJob]").is(":checked"),t=$("[name=InsTraum]").is(":checked"),n=$("[name=InsKomfort]").is(":checked"),s=0;return 1==e||1==a||1==t||1==n?(1==e&&(s+=parseFloat($("input[name=InsLife]").attr("data-margin"))),1==a&&(s+=parseFloat($("input[name=InsJob]").attr("data-margin"))),1==t&&(s+=parseFloat($("input[name=InsTraum]").attr("data-margin"))),1==n&&(s+=parseFloat($("input[name=InsKomfort]").attr("data-margin")))):s=0,s}function recalc(){var e=parseInt($("#iterations").val()),a=parseInt($("#summa_zaim").val()),t=$("#margin").val(),n=$("#chgps").val();e<3&&$.each(programm_limit,(function(s,o){a>=parseInt(o.sum_min)&&a<=parseInt(o.sum_max)&&(n!=o.chgps&&$("#chgps").val(o.chgps),t!=o.margin&&($("#iterations").val(e+1),$("#margin").val(o.margin),$("#chgps").val(o.chgps),mainCalc()))}))}function calc_partner_rewards(){try{var a=parseInt($("#months").val())}catch(t){console.log(e);a=0}try{var t=parseFloat($("#allSumm").val())}catch(a){console.log(e);t=0}try{var n=parseFloat($("#avans_to_partner").val())}catch(a){console.log(e);n=0}try{var s=parseFloat($("[name=summ_sured]").val());isNaN(s)&&(s=0)}catch(a){console.log(e);s=0}try{var o=parseFloat($("#partner_reward").val())}catch(a){console.log(e);o=0}try{var i=$("#programm").val()}catch(e){console.log(e);i=""}var r=0;r=(t-=n)*(o/100);var l=0;($("#ins_life").is(":checked")||$("#ins_life_plus").is(":checked")||$("#ins_trauma").is(":checked"))&&0!==i.indexOf("Мобилка")&&(t<=5e4?l=t*a*.0018:t<=1e5?l=t*a*.0012:t<=2e5?l=t*a*9e-4:t>200001&&(l=t*a*6e-4),$("#ins_life_plus").is(":checked")&&(l*=2),$("#ins_trauma").is(":checked")&&(l=t*a*.0018)),r+=l;var p=0;$("#sms_inform").is(":checked")&&(a<=3&&(p=30),a>=4&&(p=10*a)),console.log(l),r+=p,isNaN(r)&&(r=0);var c=0;$("#bsplus").is(":checked")&&(c+=l>0?636:549.875),$("#bs").is(":checked")&&(c+=l>0?456:399.95),$("#prioritet").is(":checked")&&(c+=l>0?199.5:171),$("#hit").is(":checked")&&(c+=l>0?420:360),$("#hitplus").is(":checked")&&(c+=l>0?630:540),r+=c;var d=0;$("#covid_1").is(":checked")&&(d=l>0?1990*.24:400.00000000074),$("#covid_2").is(":checked")&&(d=l>0?717.6:599.99999999979),r+=d;var u=0;$("#moment_protect_1").is(":checked")&&(u=l>0?220.5:189),$("#moment_protect_2").is(":checked")&&(u=l>0?336:288),r+=u;var m=0;console.log(l);var _=l>0?.21:.18;$("#sber_nc_1").is(":checked")&&(m=parseFloat($("#sber_nc_1").attr("data-price"))*_);$("#sber_nc_2").is(":checked")&&(m=parseFloat($("#sber_nc_2").attr("data-price"))*_);$("#sber_nc_3").is(":checked")&&(m=parseFloat($("#sber_nc_3").attr("data-price"))*_);$("#sber_nc_zdz_1").is(":checked")&&(m=parseFloat($("#sber_nc_zdz_1").attr("data-price"))*_);$("#sber_nc_zdz_2").is(":checked")&&(m=parseFloat($("#sber_nc_zdz_2").attr("data-price"))*_);r+=m;var h=0;$("#sber_nc_im_1").is(":checked")&&(h=parseFloat($("#sber_nc_im_1").attr("data-price"))*_);$("#sber_nc_im_2").is(":checked")&&(h=parseFloat($("#sber_nc_im_2").attr("data-price"))*_);return r+=h,"10/10/10 Супер* 0% (0/0 — 0%)"==i&&(r=0),r}function resetForm2(){$("input[name=summ]").removeClass("valid").val("").removeClass("notValid"),$("select[name=months]").empty(),$("select[name=avans]").empty(),$("select[name=programm] option").eq(0).prop("selected",!0),$("input[name=summa_zaim]").val(""),$("input[name=monthly_installment]").val(""),$("#ins_block input[type=checkbox]").each((function(){$(this).prop("checked",!1)})),$("input[name=partner_installment]").prop("checked",!1),$(".preditog span").text("")}var programm_limit,token=dadata_token;function gender2str(e){return"MALE"===e?1:"FEMALE"===e?0:""}function fioAlert(e,a,t,n){showPopup(""==e?{text:"Вы не ввели ФИО!"}:{title:"Внимание!",text:""==a&&""==t&&""==n?'<p>Не удалось определить ФИО. Пожалуйста заполните форму ниже:</p>\n                            <label>Фамилия</label><input type="text" name="manual_last_name" maxlength="25" placeholder="Фамилия">\n                            <label>Имя</label><input type="text" name="manual_first_name" maxlength="25" placeholder="Имя">\n                            <label>Отчество</label><input type="text" name="manual_father_name" maxlength="25" placeholder="Отчество">':'<p>Не удалось определить ФИО. Пожалуйста заполните форму ниже:</p>\n                            <label>Фамилия</label><input type="text" name="manual_last_name" placeholder="Фамилия" maxlength="25" value="'+a+'">\n                            <label>Имя</label><input type="text" name="manual_first_name" placeholder="Имя" maxlength="25" value="'+t+'">\n                            <label>Отчество</label><input type="text" name="manual_father_name" placeholder="Отчество" maxlength="25" value="'+n+'">',links:[{link_text:"Подтвердить",link_class:"accept-manual-fio",link:"#"}],classes:"set-fio"})}function checkCorrectDate(e){return new RegExp("^((((0?[1-9].(0?[1-9]|1[0-2]))|([12][0-9].((0?[13-9])|1[0-2]))|(((1[0-9])|(2[0-8])).0?2)|(30.((0?[13-9])|1[0-2]))|(31.((0?[13578])|10|12))).[0-9]{4})|(29.0?2.(([0-9]{2}((0[48])|([2468][048])|([13579][26])))|((([02468][048])|([13579][26]))00))))$").test(e)}function showGeoModal(){$("#geo-select-modal").slideDown(200),$("body").addClass("modal-open")}function checkPoint(){$.ajax({type:"POST",url:"user/get_prefix?"+(new Date).getTime(),beforeSend:function(){},success:function(e){e||showGeoModal()},error:function(e,a){return showPopup({text:"Возникла ошибка: "+e.responseText}),!1}})}function showPopup(e){e.title||""==e.title||(e.title="Внимание"),e.text||""==e.text||(e.text=""),e.links||(e.links=[{link_text:"ok",link_class:"closepopup",link:"#"}]),e.classes||(e.classes="");for(var a="",t=e.links.length,n=0;n<t;n++)a+='<a href="'+e.links[n].link+'" class="'+e.links[n].link_class+'">'+e.links[n].link_text+"</a>";$("#popup").addClass(e.classes),$("#popup .popup-title").html(e.title),$("#popup .popup-text").html(e.text),$("#popup .popup-buttons").html(a),$(".popup-bg").fadeIn(200),$("#popup").slideDown(300)}function closePopup(){$("#popup").removeClass(),$(".popup-bg").fadeOut(200),$("#popup").slideUp(300)}function getPDF(e,a){$.ajax({type:"GET",url:api+"/api/v1/getTemplate?"+(new Date).getTime(),data:{techId:e,type:a},beforeSend:function(){$("#doc_modal .print_template").html(preloader)},success:function(e){console.log(e),$("#doc_modal .print_template").html(e),$("#doc_modal").modal("show")},error:function(e,a){return showPopup({text:"Возникла ошибка: "+e.responseText}),!1}})}function getDogovor(e){$.ajax({type:"GET",url:api+"/api/v1/getContractBody?"+(new Date).getTime(),data:{href:e},beforeSend:function(){},success:function(e){var a=e.body;a&&""!=a&&downloadPDF(a),console.log(e)},error:function(e,a){return showPopup({text:"Возникла ошибка: "+e.responseText}),!1}})}function downloadPDF(e){var a="data:application/pdf;base64,"+e,t=document.createElement("a");t.href=a,t.download="Documents.pdf",t.click()}function getProgrammSet(e,a,t,n,s){console.log(s);var o=$("input[name=accounting_avans]").val();$.ajax({type:"POST",url:"user/getProgramm?"+(new Date).getTime(),data:{programm:e,summ:a,month:t,avans:n,accounting_avans:o},beforeSend:function(){$("#second_form").prepend('<div class="blocker">'+preloader+"</div>")},success:function(e){$(".blocker").remove(),e=jQuery.parseJSON(e),console.log(e),1==e.error?(showPopup({text:e.error_msg}),$("#programm option").eq(0).prop("selected",!0)):(t<=3?$("input[name=InsJob]").prop("disabled",!0):$("input[name=InsJob]").prop("disabled",!1),s?"months"==s?(setAvans(e),setValues()):("avans"==s||setAvans(e),setValues()):(programmSettings(e),setMonths(e),setAvans(e),setValues()))},error:function(e,a){return $(".blocker").remove(),showPopup({text:"Возникла ошибка: "+e.responseText}),!1}})}function setMonths(e){var a="",t=[];$.each(e.programms,(function(e,a){t.push(parseInt(a.month))})),t=array_uniq(t).sort(compareNumeric),$.each(t,(function(e,t){a+='<option value="'+t+'">'+t+"</option>"})),$("select[name=months]").html(a)}function setAvans(e){var a,t=[];console.log(e),$.each(e.programms,(function(e,a){t.push(parseFloat(a.avans))})),t=array_uniq(t).sort(compareNumeric),$.each(t,(function(e,t){a+='<option value="'+t+'">'+t+"</option>"})),$("select[name=avans]").html(a)}function setValues(){var e=$("#months").val(),a=$("#programm").val(),t=$("input[name=summ]").val(),n=$("#avans").val(),s=$("input[name=accounting_avans]").val();$.ajax({type:"POST",url:"user/getProgramm?"+(new Date).getTime(),data:{programm:a,summ:t,month:e,avans:n,accounting_avans:s},beforeSend:function(){$("#second_form").prepend('<div class="blocker">'+preloader+"</div>")},success:function(e){$(".blocker").remove(),e=jQuery.parseJSON(e),console.log(e),1==e.error?(showPopup({text:e.error_msg}),$("#programm option").eq(0).prop("selected",!0)):($("#chgps").val(e.programms[0].chgps),$("#margin").val(e.programms[0].margin),$("#proc2client").val(e.programms[0].proc2client),$("#partner_discount").val(e.programms[0].partner_discount),$("#isPreferentialProgramm").val(e.programms[0].partner_discount),$("#discount").val(e.programms[0].discount),$("#sms_inform").attr("data-price",e.sms),$("input[name=partner_reward]").val(e.programms[0].partner_reward),programm_limit=e.limit_full,$("#iterations").val("0"),$("input[name=accounting_avans]").val(e.programms_set.accounting_avans),setAvans(e),$.each(e.insurance,(function(e,a){switch(a.insurance){case"life_insurance":$("#ins_life").attr("data-margin",a.margin);break;case"job_insurance":$("#ins_life_plus").attr("data-margin",a.margin);break;case"trauma_insurance":$("#ins_trauma").attr("data-margin",a.margin);break;case"komfort_insurance":$("#ins_komfort").attr("data-margin",a.margin)}}))),mainCalc()},error:function(e,a){return $(".blocker").remove(),showPopup({text:"Возникла ошибка: "+e.responseText}),!1}})}function resetProgramm(){$("#programm option").eq(0).prop("selected",!0)}function programmSettings(e){var a=e.programms_set;$("input[name=partner_installment]").prop("checked",checkBoolean(a.installments_state)),$("#partner_installment_block").show(),$("input[name=InsLife]").prop("checked",checkBooleanSC($("input[name=InsLife]").attr("data-sc"),checkBoolean(a.insurance_life_state),checkBoolean(a.insurance_life_enabled),checkBoolean(a.insurance_life_visible))),$("input[name=InsJob]").prop("checked",checkBooleanSC($("input[name=InsJob]").attr("data-sc"),checkBoolean(a.insurance_job_state),checkBoolean(a.insurance_job_enabled),checkBoolean(a.insurance_job_visible))),$("input[name=InsTraum]").prop("checked",checkBooleanSC($("input[name=InsTraum]").attr("data-sc"),checkBoolean(a.insurance_traum_state),checkBoolean(a.insurance_traum_enabled),checkBoolean(a.insurance_traum_visible))),$("input[name=InsKomfort]").prop("checked",checkBooleanSC($("input[name=InsKomfort]").attr("data-sc"),checkBoolean(a.insurance_komfort_state),checkBoolean(a.insurance_komfort_enabled),checkBoolean(a.insurance_komfort_visible))),$("input[name=sms]").prop("checked",checkBooleanSC($("input[name=sms]").attr("data-sc"),checkBoolean(a.sms_state),checkBoolean(a.insurance_sms_enabled),checkBoolean(a.insurance_sms_visible))),"true"===$("input[name=bsplus_short]").attr("data-sc")?$("input[name=bsplus_short]").prop("checked",!0):$("input[name=bsplus_short]").prop("checked",!1),"true"===$("input[name=bs_short]").attr("data-sc")?$("input[name=bs_short]").prop("checked",!0):$("input[name=bs_short]").prop("checked",!1),"true"===$("input[name=prioritet_short]").attr("data-sc")?$("input[name=prioritet_short]").prop("checked",!0):$("input[name=prioritet_short]").prop("checked",!1),"true"===$("input[name=hit_short]").attr("data-sc")?$("input[name=hit_short]").prop("checked",!0):$("input[name=hit_short]").prop("checked",!1),"true"===$("input[name=hitplus_short]").attr("data-sc")?$("input[name=hitplus_short]").prop("checked",!0):$("input[name=hitplus_short]").prop("checked",!1),"true"===$("input[name=covid]").attr("data-sc")?$("input[name=covid]").prop("checked",!0):$("input[name=covid]").prop("checked",!1),"true"===$("input[name=covid_plus]").attr("data-sc")?$("input[name=covid_plus]").prop("checked",!0):$("input[name=covid_plus]").prop("checked",!1),"true"===$("input[name=moment_protect]").attr("data-sc")?$("input[name=moment_protect]").prop("checked",!0):$("input[name=moment_protect]").prop("checked",!1),"true"===$("input[name=moment_protect_plus]").attr("data-sc")?$("input[name=moment_protect_plus]").prop("checked",!0):$("input[name=moment_protect_plus]").prop("checked",!1),$("input[name=InsLife]").prop("disabled",!checkBoolean(a.insurance_life_enabled)),$("input[name=InsJob]").prop("disabled",!checkBoolean(a.insurance_job_enabled)),$("input[name=InsTraum]").prop("disabled",!checkBoolean(a.insurance_traum_enabled)),$("input[name=InsKomfort]").prop("disabled",!checkBoolean(a.insurance_komfort_enabled)),$("input[name=sms]").prop("disabled",!checkBoolean(a.sms_enabled)),checkBoolean(a.installments_enabled)?"true"==$("input[name=partner_installment]").attr("data-locked")?($("input[name=partner_installment]").prop("checked",!1),$("input[name=partner_installment] + label").removeAttr("for"),$("#partner_installment_block").hide()):($("input[name=partner_installment] + label").attr("for","partner_installment"),$("#partner_installment_block").show()):($("input[name=partner_installment] + label").removeAttr("for"),$("input[name=partner_installment]").prop("checked")?$("#partner_installment_block").show():$("#partner_installment_block").hide()),$("input[name=partner_installment]").css("disabled",!checkBoolean(a.installments_enabled)),$("input[name=InsLife] + label").css({display:checkBoolean(a.insurance_life_visible)?"block":"none"}),$("input[name=InsJob] + label").css({display:checkBoolean(a.insurance_job_visible)?"block":"none"}),$("input[name=InsTraum] + label").css({display:checkBoolean(a.insurance_traum_visible)?"block":"none"}),$("input[name=InsKomfort] + label").css({display:checkBoolean(a.insurance_komfort_visible)?"block":"none"}),$("#avans_block").css({display:checkBoolean(a.avans_visible)?"inline-block":"none"}),$("#partner_discount_block").css({display:checkBoolean(a.partner_discount_visible)?"inline-block":"none"}),$("#avans_to_partner").prop("readonly",!checkBoolean(a.money_to_supplier_editable)),$("#months").prop("readonly",!checkBoolean(a.months_enabled)),$("input[name=max_summ_tovar]").val(a.max_summ_tovar),$("input[name=min_summ_tovar]").val(a.min_summ_tovar),$("input[name=max_summ]").val(a.max_summ),$("input[name=min_summ]").val(a.min_summ),$("input[name=accounting_avans]").val(a.accounting_avans),console.log(e.programms_set),"true"==$("input[name=sms]").attr("data-sc")&&!checkBoolean(a.sms_state)||checkBoolean(a.sms_state)?$("input[name=sms]").prop("checked",!0):$("input[name=sms]").prop("checked",!1),"true"==$("input[name=bsplus_short]").attr("data-sc")?$("input[name=bsplus_short]").prop("checked",!0):$("input[name=bsplus_short]").prop("checked",!1)}function checkBoolean(e){return"0"!=e&&0!=e&&("1"==e||1==e||void 0)}function checkBooleanSC(e,a,t,n){return 1==a||"true"==e&&1==a||"true"==e&&0==a&&1==t&&1==n}function compareNumeric(e,a){return e>a?1:e==a?0:e<a?-1:void 0}function array_uniq(e){var a={};return e.filter((function(e){return!a[e]&&(a[e]=!0)}))}function sendRecon(e){$.ajax({type:"POST",url:"main/sendRecon?"+(new Date).getTime(),data:{id_app:e},beforeSend:function(){},success:function(e){var a=$.parseJSON(e);console.log(a),1==a.sucess?getApp():1==a.error&&showPopup({text:a.error_msg,links:[{link_text:"Закрыть",link_class:"closepopup",link:"#"}]})}})}function checkSBPCodes(e){var a=$("input[name=uuid]").val(),t=createArrayCodes(e);console.log(t),$.ajax({type:"POST",url:api+"/api/v1/checkSignPayment?"+(new Date).getTime(),data:{uuid:a,codes:JSON.stringify(t)},beforeSend:function(){e.find("button").addClass("disabled").text("Ожидайте")},success:function(a){e.find("button").removeClass("disabled").text("Отправить");var t=a;if(1==t.error)showPopup({text:t.error_msg});else if(1==t.success)location.reload();else{var n=0;if($.each(t,(function(a,t){(t.error||3!=t.status)&&(addClassValid(e.find("input[name="+a+"]"),!1),n++)})),n>0)showPopup({text:"Неверный код подтверждения."});else;}},error:function(a,t){return e.find("button").removeClass("disabled").text("Подписать"),showPopup({text:"Возникла ошибка: "+a.responseText}),!1}})}function getSbpById(e){(""==$("#second_form input[name=sbp_phone]").val()&&""==$("#second_form select[name=sbp_bank_id_a]").val()||""==$("#second_form input[name=sbp_bank_text_a]").val())&&$.ajax({type:"POST",url:"main/getSBP1etap?"+(new Date).getTime(),data:{idApp:e},beforeSend:function(){},success:function(e){e=jQuery.parseJSON(e),console.log(e),e.error_msg||1==e.success&&($("#second_form input[name=sbp_bank_text_a]").val(e.sbp_bank_text_a),$("#second_form input[name=sbp_phone]").val(e.sbp_phone),$("#second_form select[name=sbp_bank_id_a] option[value="+e.sbp_bank_id_a+"]").prop("selected",!0),$("#second_form input[name=sbp_bank_text_a]").val(e.sbp_bank_text_a),$("#second_form select[name=sbp_bank_id_a]").trigger("chosen:updated"),""!=e.sbp_phone&&addClassValid($("#second_form input[name=sbp_phone]"),!0))},error:function(e,a){return showPopup({text:"Возникла ошибка: "+e.responseText}),!1}})}$("input[name=clearing_payee_bankbik]").suggestions({token:token,type:"BANK",onSelect:function(e){$("input[name=clearing_payee_bankbik]").removeClass("valid notValid");var a=e.data.bic,t=e.value,n=e.data.correspondent_account,s=e.data.inn,o=e.data.kpp,i=($("input[name=last_name]").val(),$("input[name=first_name]").val(),$("input[name=father_name]").val(),$("input[name=clearing_payee_personalacc]").val());"BANK"!=e.data.opf.type&&"BANK_BRANCH"!=e.data.opf.type||"ACTIVE"!=e.data.state.status?(console.log(e),showAlert("В данный момент нет возможности перечислить на такие реквизиты"),$("input[name=clearing_payee_bankbik]").val("")):($("input[name=clearing_payee_bankbik]").val(a),$("input[name=clearing_payee_bankname]").val(t),$("input[name=clearing_payee_inn]").val(s),$("input[name=clearing_payee_kpp]").val(o),$("input[name=clearing_payee_bankcorracc]").val(n),addClassValid($("input[name=clearing_payee_bankbik]"),!0),addClassValid($("input[name=clearing_payee_bankname]"),!0),addClassValid($("input[name=clearing_payee_inn]"),!0),addClassValid($("input[name=clearing_payee_kpp]"),!0),addClassValid($("input[name=clearing_payee_bankcorracc]"),!0),console.log(e)),1==validateRs(i,a,{code:0,message:""})?addClassValid($("input[name=clearing_payee_personalacc]"),!0):addClassValid($("input[name=clearing_payee_personalacc]"),!1)}}),$("#fio").suggestions({token:token,type:"NAME",hint:"Выбирите один из вариантов",onSelectNothing:function(e){console.log(e,"Имя: "+$("input[name=first_name]").val()+",фамилия : "+$("input[name=last_name]").val()+", Отчество: "+$("input[name=father_name]").val()),fioAlert(e,$("input[name=last_name]").val(),$("input[name=first_name]").val(),$("input[name=father_name]").val())},onSelect:function(e){console.log(e),$("input[name=sex]").val(gender2str(e.data.gender)),null!=e.data.name&&null!=e.data.surname?($("input[name=first_name]").val(e.data.name),$("input[name=last_name]").val(e.data.surname),null!=e.data.patronymic?($("input[name=father_name]").val(e.data.patronymic),$("input[name=noOtchesvo]").val("0")):($("input[name=father_name]").val(""),$("input[name=noOtchesvo]").val("1")),$("#fio").addClass("valid").removeClass("notValid")):$("#fio").removeClass("valid").addClass("notValid"),setSourceIncome()}}),$("#pass_code").suggestions({token:token,type:"fms_unit",onSuggestionsFetch:function(e){0==e.length&&(console.log("Нет кода"),$("#pass_code").addClass("semi-valid"),$(".pass_whom_block").show().attr("data-need",1))},onSelect:function(e){""!=e.data.code&&""!=e.data.name&&($("#pass_code").removeClass("notValid").addClass("valid").val(e.data.code),$("input[name=pass_whom]").val(e.data.name).removeAttr("data-need"),$("#pass_code").removeClass("semi-valid"),$(".pass_whom_block").hide()),console.log(e)}}),$("input[name=insured_address]").suggestions({token:token,type:"ADDRESS",onSelect:function(e){}}),$("[name=one_string_adres_registration]").suggestions({token:token,type:"ADDRESS",hint:!1,onSuggestionsFetch:function(e){0==e.length&&(console.log("Нет адреса"),$("[name=one_string_adres_registration]").addClass("semi-valid"),$("[name=adress_registration_incorrect]").val(1))},onSelect:function(e){var a=$("[name=one_string_adres_registration]");a.removeClass("semi-valid"),$("[name=adress_registration_incorrect]").val(0),console.log(e.data),$("[name=fias_id_registration]").val(e.data.fias_id),$("[name=okato_registration]").val(e.data.okato),$("[name=obl_registration]").val(e.data.region_with_type);try{$("[name=region_registration]").val(e.data.kladr_id.substr(0,2))}catch(e){$("[name=region_registration]").val("")}$("[name=adress_code_registration]").val(e.data.kladr_id);var t=e.data.city+" "+e.data.city_type;if(null==e.data.city_with_type?($("[name=locality_registration]").val(""),null==e.data.settlement_with_type?($("[name=countryside_registration]").val(""),addClassValid(a,!1),$(".clone_reg").hide()):($("[name=countryside_registration]").val(e.data.settlement_with_type),addClassValid(a,!0),$(".clone_reg").show())):($("[name=locality_registration]").val(t),null!=e.data.settlement_with_type&&$("[name=countryside_registration]").val(e.data.settlement_with_type),addClassValid(a,!0),$(".clone_reg").show()),$("[name=ray_registration]").val(e.data.area_with_type),$("[name=postalcode_registration]").val(e.data.postal_code),null!=e.data.street){var n=e.data.street+" "+e.data.street_type;$("[name=street_registration]").val(n),$("#registration_street_off").prop("checked",!1)}else $("[name=street_registration]").val(""),$("#registration_street_off").prop("checked",!0);null==e.data.house||null==e.data.house?($("[name=home_registration]").val(""),$("#registration_home_off").prop("checked",!0)):($("[name=home_registration]").val(e.data.house),$("#registration_home_off").prop("checked",!1)),null==e.data.flat||null==e.data.flat?($("[name=apartment_registration]").val(""),$("#registration_apartment_off").prop("checked",!0)):($("[name=apartment_registration]").val(e.data.flat),$("#registration_apartment_off").prop("checked",!1))}}),$("[name=one_string_adres_living]").suggestions({token:token,type:"ADDRESS",hint:!1,onSuggestionsFetch:function(e){0==e.length&&(console.log("Нет адреса"),$("[name=one_string_adres_living]").addClass("semi-valid"),$("[name=adress_living_incorrect]").val(1))},onSelect:function(e){var a=$("[name=one_string_adres_living]");a.removeClass("semi-valid"),$("[name=adress_living_incorrect]").val(0),console.log(e.data),$("[name=fias_id_living]").val(e.data.fias_id),$("[name=okato_living]").val(e.data.okato),$("[name=obl_living]").val(e.data.region_with_type);try{$("[name=region_living]").val(e.data.kladr_id.substr(0,2))}catch(e){$("[name=region_living]").val("")}$("[name=adress_code_living]").val(e.data.kladr_id);var t=e.data.city+" "+e.data.city_type;if(null==e.data.city_with_type?($("[name=locality_living]").val(""),null==e.data.settlement_with_type?($("[name=countryside_living]").val(""),addClassValid(a,!1)):($("[name=countryside_living]").val(e.data.settlement_with_type),addClassValid(a,!0))):(null!=e.data.settlement_with_type&&$("[name=countryside_living]").val(e.data.settlement_with_type),$("[name=locality_living]").val(t),addClassValid(a,!0)),$("[name=ray_living]").val(e.data.area_with_type),$("[name=postalcode_living]").val(e.data.postal_code),null!=e.data.street){var n=e.data.street+" "+e.data.street_type;$("[name=street_living]").val(n),$("#living_street_off").prop("checked",!1)}else $("[name=street_living]").val(""),$("#living_street_off").prop("checked",!0);null==e.data.house||null==e.data.house?($("[name=home_living]").val(""),$("#living_home_off").prop("checked",!0)):($("[name=home_living]").val(e.data.house),$("#living_home_off").prop("checked",!1)),null==e.data.flat||null==e.data.flat?($("[name=apartment_living]").val(""),$("#living_apartment_off").prop("checked",!0)):($("[name=apartment_living]").val(e.data.flat),$("#living_apartment_off").prop("checked",!1))}}),$(".clone_reg").click((function(e){e.preventDefault(),$("[name=one_string_adres_living]").val($("[name=one_string_adres_registration]").val()),addClassValid($("[name=one_string_adres_living]"),!0),$("[name=one_string_adres_registration]").hasClass("semi-valid")?$("[name=one_string_adres_living]").addClass("semi-valid"):$("[name=one_string_adres_living]").removeClass("semi-valid"),$(".registration-fields input").each((function(){var e=$(this).attr("name").replace("registration","living"),a=$(this).val();if($(".living-fields input[name="+e+"]").val(a),"checkbox"==$(this).attr("type")){var t=$(this).prop("checked");console.log(e,t),$(".living-fields input[name="+e+"]").prop("checked",t)}}))})),$(document).on("click",".accept-manual-fio",(function(e){e.preventDefault();var a=$(".set-fio input[name=manual_last_name]").hasClass("notValid")?"":$(".set-fio input[name=manual_last_name]").val().trim(),t=$(".set-fio input[name=manual_first_name]").hasClass("notValid")?"":$(".set-fio input[name=manual_first_name]").val().trim(),n=$(".set-fio input[name=manual_father_name]").hasClass("notValid")?"":$(".set-fio input[name=manual_father_name]").val().trim();""!=a&&""!=t&&($("input[name=first_name]").val(t),$("input[name=last_name]").val(a),""!=n?($("input[name=father_name]").val(n),$("input[name=noOtchesvo]").val("0")):($("input[name=father_name]").val(""),$("input[name=noOtchesvo]").val("1")),$("#fio").addClass("valid").removeClass("notValid"),$("#fio").val(a+" "+t+" "+n),closePopup())})),$(document).on("change",".date-type",(function(){checkCorrectDate($(this).val())?$(this).removeClass("notValid"):addClassValid($(this),!1)})),$(document).ready((function(){$("#geo-select input[type=radio]").change((function(){var e=$(this).attr("data-prefix");$("#geo-select input[name=prefix]").val(e)})),$("#geo-select").submit((function(e){e.preventDefault();$("#geo-select").serialize();var a=$("#geo-select input[name=id]:checked").val(),t=$("#geo-select input[name=prefix]").val();$.ajax({type:"POST",url:"user/set_prefixId?"+(new Date).getTime(),data:{id:a,prefix:t},beforeSend:function(){},success:function(e){1==(e=jQuery.parseJSON(e)).success?window.location="/":console.log(e)},error:function(e,a){return showPopup({text:"Возникла ошибка: "+e.responseText}),!1}})})),$(".change-geo").click((function(e){e.preventDefault(),showPopup({title:"Внимание",text:"Все данные будут сброшены, Вы уверены, что хотите продолжить?",links:[{link_text:"Нет",link_class:"closepopup",link:"#"},{link_text:"Да",link_class:"show-geolist",link:"#"}]})}))})),$(document).on("click",".show-geolist",(function(){showGeoModal(),closePopup()})),$(document).on("click",".pass-button",(function(){showPopup({title:"Прикрепить файл",text:'<span>Паспорт 1-й разворот</span>\n                <div class="file-wrap"><input type="file" name="pass_scan_1" id="pass_scan_1"><span>'+(""!=$("input[name=pass1_resized]").val()?$(".file1-info span").text():"Выбрать файл")+'</span></div>\n                <span>Паспорт регистрация</span>\n                <div class="file-wrap"><input type="file" name="pass_scan_2" id="pass_scan_2"><span>'+(""!=$("input[name=pass2_resized]").val()?$(".file2-info span").text():"Выбрать файл")+"</span></div>",links:[{link_text:"отмена",link_class:"closepopup",link:"#"}]})})),$(document).on("click",".spravka-button",(function(){showPopup({title:"Прикрепить файл",text:'<span>Справка о доходах</span>\n                <div class="file-wrap"><input type="file" name="spravka_scan_1" id="spravka_scan_1"><span>'+(""!=$("input[name=spravka1_resized]").val()?$(".file3-info span").text():"Выбрать файл")+'</span></div>\n                <span>Справка о доходах</span>\n                <div class="file-wrap"><input type="file" name="spravka_scan_2" id="spravka_scan_2"><span>'+(""!=$("input[name=spravka2_resized]").val()?$(".file4-info span").text():"Выбрать файл")+"</span></div>",links:[{link_text:"отмена",link_class:"closepopup",link:"#"}]})})),$(document).on("click",".remove_file",(function(e){e.preventDefault();var a=$(this).attr("data-file");$("input[name="+a+"]").val(""),$(this).parent().find("span").text(""),$(this).parent().hide()})),$(document).on("change","input[name=pass_scan_1]",(function(){var e=$(this).val(),a=this.files[0].size/1078574,t=$(this).attr("id"),n=e.split(".").pop().toLowerCase(),s=$(this).parent().find("span");e=e.split("\\"),console.log(e);var o=e.length-1,i=String(e[o]),r=document.getElementById(t).files[0];if("jpg"==n||"jpeg"==n||"png"==n||"gif"==n){var l=new window.resize;l.init(),l.photo(r,1024,"dataURL",(function(e){$("input[name=pass1_resized]").val(e),s.text(i),$(".file1-info").show(),$(".file1-info span").text(i),closePopup()}))}else if("pdf"==n)if(a>2)$(this).val(""),alert("Допустимый размер файла не более 2 Мб");else{var p=new FileReader;p.onloadend=function(){$("input[name=pass1_resized]").val(p.result),s.text(i),$(".file1-info").show(),$(".file1-info span").text(i),closePopup()},p.readAsDataURL(r)}else $(this).val(""),alert("Недопустимый тип файла. Пожалуйста выберите другой файл. Допустимые типы файлов: jpg, jpeg, png, gif, pdf")})),$(document).on("change","input[name=pass_scan_2]",(function(){var e=$(this).val(),a=this.files[0].size/1078574,t=$(this).attr("id"),n=e.split(".").pop().toLowerCase(),s=$(this).parent().find("span");e=e.split("\\"),console.log(e);var o=e.length-1,i=String(e[o]),r=document.getElementById(t).files[0];if("jpg"==n||"jpeg"==n||"png"==n||"gif"==n){var l=new window.resize;l.init(),l.photo(r,1024,"dataURL",(function(e){$("input[name=pass2_resized]").val(e),s.text(i),$(".file2-info").show(),$(".file2-info span").text(i),closePopup()}))}else if("pdf"==n)if(a>2)$(this).val(""),alert("Допустимый размер файла не более 2 Мб");else{var p=new FileReader;p.onloadend=function(){$("input[name=pass2_resized]").val(p.result),s.text(i),$(".file2-info").show(),$(".file2-info span").text(i),closePopup()},p.readAsDataURL(r)}else $(this).val(""),alert("Недопустимый тип файла. Пожалуйста выберите другой файл. Допустимые типы файлов: jpg, jpeg, png, gif, pdf")})),$(document).on("change","input[name=spravka_scan_1]",(function(){var e=$(this).val(),a=this.files[0].size/1078574,t=$(this).attr("id"),n=e.split(".").pop().toLowerCase(),s=$(this).parent().find("span");e=e.split("\\"),console.log(e);var o=e.length-1,i=String(e[o]),r=document.getElementById(t).files[0];if("jpg"==n||"jpeg"==n||"png"==n||"gif"==n){var l=new window.resize;l.init(),l.photo(r,1024,"dataURL",(function(e){$("input[name=spravka1_resized]").val(e),s.text(i),$(".file3-info").show(),$(".file3-info span").text(i),closePopup()}))}else if("pdf"==n)if(a>2)$(this).val(""),alert("Допустимый размер файла не более 2 Мб");else{var p=new FileReader;p.onloadend=function(){$("input[name=spravka1_resized]").val(p.result),s.text(i),$(".file3-info").show(),$(".file3-info span").text(i),closePopup()},p.readAsDataURL(r)}else $(this).val(""),alert("Недопустимый тип файла. Пожалуйста выберите другой файл. Допустимые типы файлов: jpg, jpeg, png, gif, pdf")})),$(document).on("change","input[name=spravka_scan_2]",(function(){var e=$(this).val(),a=this.files[0].size/1078574,t=$(this).attr("id"),n=e.split(".").pop().toLowerCase(),s=$(this).parent().find("span");e=e.split("\\"),console.log(e);var o=e.length-1,i=String(e[o]),r=document.getElementById(t).files[0];if("jpg"==n||"jpeg"==n||"png"==n||"gif"==n){var l=new window.resize;l.init(),l.photo(r,1024,"dataURL",(function(e){$("input[name=spravka2_resized]").val(e),s.text(i),$(".file4-info").show(),$(".file4-info span").text(i),closePopup()}))}else if("pdf"==n)if(a>2)$(this).val(""),alert("Допустимый размер файла не более 2 Мб");else{var p=new FileReader;p.onloadend=function(){$("input[name=spravka2_resized]").val(p.result),s.text(i),$(".file4-info").show(),$(".file4-info span").text(i),closePopup()},p.readAsDataURL(r)}else $(this).val(""),alert("Недопустимый тип файла. Пожалуйста выберите другой файл. Допустимые типы файлов: jpg, jpeg, png, gif, pdf")})),$(document).on("change","#ins_block input[type=checkbox]",(function(){"ins_life"==$(this).attr("id")&&($("#ins_life_plus").prop("checked",!1),$("#ins_trauma").prop("checked",!1)),"ins_life_plus"==$(this).attr("id")&&($("#ins_life").prop("checked",!1),$("#ins_trauma").prop("checked",!1)),"ins_trauma"==$(this).attr("id")&&($("#ins_life").prop("checked",!1),$("#ins_life_plus").prop("checked",!1)),"bsplus"==$(this).attr("id")&&$(".insurance_short #bs").prop("checked",!1),"bs"==$(this).attr("id")&&$(".insurance_short #bsplus").prop("checked",!1),"prioritet"==$(this).attr("id")&&($(".insurance_short #hit").prop("checked",!1),$(".insurance_short #hitplus").prop("checked",!1)),"hit"==$(this).attr("id")&&($(".insurance_short #prioritet").prop("checked",!1),$(".insurance_short #hitplus").prop("checked",!1)),"hitplus"==$(this).attr("id")&&($(".insurance_short #hit").prop("checked",!1),$(".insurance_short #prioritet").prop("checked",!1)),"covid_1"==$(this).attr("id")&&$(".insurance_short #covid_2").prop("checked",!1),"covid_2"==$(this).attr("id")&&$(".insurance_short #covid_1").prop("checked",!1),"moment_protect_1"==$(this).attr("id")&&$(".insurance_short #moment_protect_2").prop("checked",!1),"moment_protect_2"==$(this).attr("id")&&$(".insurance_short #moment_protect_1").prop("checked",!1),"sber_nc_1"==$(this).attr("id")&&($(".insurance_short #sber_nc_2").prop("checked",!1),$(".insurance_short #sber_nc_3").prop("checked",!1)),"sber_nc_2"==$(this).attr("id")&&($(".insurance_short #sber_nc_1").prop("checked",!1),$(".insurance_short #sber_nc_3").prop("checked",!1)),"sber_nc_3"==$(this).attr("id")&&($(".insurance_short #sber_nc_1").prop("checked",!1),$(".insurance_short #sber_nc_2").prop("checked",!1)),"sber_nc_zdz_1"==$(this).attr("id")&&$(".insurance_short #sber_nc_zdz_2").prop("checked",!1),"sber_nc_zdz_2"==$(this).attr("id")&&$(".insurance_short #sber_nc_zdz_1").prop("checked",!1),"sber_nc_im_1"==$(this).attr("id")&&$(".insurance_short #sber_nc_im_2").prop("checked",!1),"sber_nc_im_2"==$(this).attr("id")&&$(".insurance_short #sber_nc_im_1").prop("checked",!1);var e=$("input[name=app_id]").val();getClientBirth(e)})),$(document).on("change",".insurance_short input[type=checkbox]",(function(){var e=0;$(".insurance_short input[type=checkbox]").each((function(){$(this).prop("checked")&&(e+=parseFloat($(this).attr("data-price")))})),$("#summ_sured").val(e),$("input[name=sber_nc_im_1").prop("checked")||$("input[name=sber_nc_im_2").prop("checked")?$(".insured_address-block").slideDown(200):($(".insured_address-block").slideUp(200),$("input[name=insured_address]").val(""))})),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}((function(e){var a,t=navigator.userAgent,n=/iphone/i.test(t),s=/chrome/i.test(t),o=/android/i.test(t);e.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},autoclear:!0,dataName:"rawMaskFn",placeholder:"_"},e.fn.extend({caret:function(e,a){var t;if(0!==this.length&&!this.is(":hidden"))return"number"==typeof e?(a="number"==typeof a?a:e,this.each((function(){this.setSelectionRange?this.setSelectionRange(e,a):this.createTextRange&&((t=this.createTextRange()).collapse(!0),t.moveEnd("character",a),t.moveStart("character",e),t.select())}))):(this[0].setSelectionRange?(e=this[0].selectionStart,a=this[0].selectionEnd):document.selection&&document.selection.createRange&&(t=document.selection.createRange(),e=0-t.duplicate().moveStart("character",-1e5),a=e+t.text.length),{begin:e,end:a})},unmask:function(){return this.trigger("unmask")},mask:function(t,i){var r,l,p,c,d,u,m;if(!t&&this.length>0){var _=e(this[0]).data(e.mask.dataName);return _?_():void 0}return i=e.extend({autoclear:e.mask.autoclear,placeholder:e.mask.placeholder,completed:null},i),r=e.mask.definitions,l=[],p=u=t.length,c=null,e.each(t.split(""),(function(e,a){"?"==a?(u--,p=e):r[a]?(l.push(new RegExp(r[a])),null===c&&(c=l.length-1),p>e&&(d=l.length-1)):l.push(null)})),this.trigger("unmask").each((function(){function _(){if(i.completed){for(var e=c;d>=e;e++)if(l[e]&&x[e]===h(e))return;i.completed.call(y)}}function h(e){return i.placeholder.charAt(e<i.placeholder.length?e:0)}function $(e){for(;++e<u&&!l[e];);return e}function f(e,a){var t,n;if(!(0>e)){for(t=e,n=$(a);u>t;t++)if(l[t]){if(!(u>n&&l[t].test(x[n])))break;x[t]=x[n],x[n]=h(n),n=$(n)}k(),y.caret(Math.max(c,e))}}function v(){b(),y.val()!=C&&y.change()}function g(e,a){var t;for(t=e;a>t&&u>t;t++)l[t]&&(x[t]=h(t))}function k(){y.val(x.join(""))}function b(e){var a,t,n,s=y.val(),o=-1;for(a=0,n=0;u>a;a++)if(l[a]){for(x[a]=h(a);n++<s.length;)if(t=s.charAt(n-1),l[a].test(t)){x[a]=t,o=a;break}if(n>s.length){g(a+1,u);break}}else x[a]===s.charAt(n)&&n++,p>a&&(o=a);return e?k():p>o+1?i.autoclear||x.join("")===w?(y.val()&&y.val(""),g(0,u)):k():(k(),y.val(y.val().substring(0,o+1))),p?a:c}var y=e(this),x=e.map(t.split(""),(function(e,a){return"?"!=e?r[e]?h(a):e:void 0})),w=x.join(""),C=y.val();y.data(e.mask.dataName,(function(){return e.map(x,(function(e,a){return l[a]&&e!=h(a)?e:null})).join("")})),y.one("unmask",(function(){y.off(".mask").removeData(e.mask.dataName)})).on("focus.mask",(function(){var e;y.prop("readonly")||(clearTimeout(a),C=y.val(),e=b(),a=setTimeout((function(){k(),e==t.replace("?","").length?y.caret(0,e):y.caret(e)}),10))})).on("blur.mask",v).on("keydown.mask",(function(e){if(!y.prop("readonly")){var a,t,s,o=e.which||e.keyCode;m=y.val(),8===o||46===o||n&&127===o?(t=(a=y.caret()).begin,(s=a.end)-t==0&&(t=46!==o?function(e){for(;--e>=0&&!l[e];);return e}(t):s=$(t-1),s=46===o?$(s):s),g(t,s),f(t,s-1),e.preventDefault()):13===o?v.call(this,e):27===o&&(y.val(C),y.caret(0,b()),e.preventDefault())}})).on("keypress.mask",(function(a){if(!y.prop("readonly")){var t,n,s,i=a.which||a.keyCode,r=y.caret();if(!(a.ctrlKey||a.altKey||a.metaKey||32>i)&&i&&13!==i){if(r.end-r.begin!=0&&(g(r.begin,r.end),f(r.begin,r.end-1)),t=$(r.begin-1),u>t&&(n=String.fromCharCode(i),l[t].test(n))){if(function(e){var a,t,n,s;for(a=e,t=h(e);u>a;a++)if(l[a]){if(n=$(a),s=x[a],x[a]=t,!(u>n&&l[n].test(s)))break;t=s}}(t),x[t]=n,k(),s=$(t),o){setTimeout((function(){e.proxy(e.fn.caret,y,s)()}),0)}else y.caret(s);r.begin<=d&&_()}a.preventDefault()}}})).on("input.mask paste.mask",(function(){y.prop("readonly")||setTimeout((function(){var e=b(!0);y.caret(e),_()}),0)})),s&&o&&y.off("input.mask").on("input.mask",(function(){var e=y.val(),a=y.caret();if(e.length<m.length){for(b(!0);a.begin>0&&!l[a.begin-1];)a.begin--;if(0===a.begin)for(;a.begin<c&&!l[a.begin];)a.begin++;y.caret(a.begin,a.begin)}else{for(b(!0);a.begin<u&&!l[a.begin];)a.begin++;y.caret(a.begin,a.begin)}_()})),b()}))}})})),$(document).on("click",".get-pdf",(function(e){e.preventDefault();var a=$(this).attr("data-type");getPDF($(this).attr("href"),a)})),$(document).on("click",".get-dogovor",(function(e){e.preventDefault(),getDogovor($(this).attr("href"))})),$(document).on("click",".get-docs-1",(function(e){e.preventDefault(),$(this).toggleClass("active"),$(".docs-1").slideToggle(200)})),$(document).on("change","#programm",(function(){getProgrammSet($(this).val())})),$(document).on("change","#months",(function(){var e=$(this).val();getProgrammSet($("#programm").val(),$("input[name=summ]").val(),e,"","months");var a=$("input[name=app_id]").val();getClientBirth(a)})),$(document).on("change","#avans",(function(){var e=$(this).val(),a=$("#months").val();getProgrammSet($("#programm").val(),$("input[name=summ]").val(),a,e,"avans")})),$(document).on("change","input[name=summ]",(function(){var e=digitsOnly($(this)),a=$("#programm").val(),t=$("#months").val(),n=$("#avans").val();a&&0!=e&&getProgrammSet(a,e,t,n,"sum")})),$(document).on("change","#ins_block input[type=checkbox], #partner_installment, #sms_inform",(function(){setValues()})),$(document).on("change,blur","#avans_to_partner",(function(){mainCalc()})),$(document).on("click","a.get-akt",(function(e){e.preventDefault();var a=$(this).attr("href");$(this).hasClass("disabled")||sendRecon(a)})),window.resize=function(){"use strict";function e(){}return e.prototype={init:function(e){this.outputQuality="undefined"===e?.8:e},photo:function(e,a,t,n){var s=this,o=new FileReader;o.onload=function(e){s.resize(e.target.result,a,t,n)},o.readAsDataURL(e)},resize:function(e,a,t,n){var s=this,o=new Image;o.onload=function(e){var i=document.createElement("canvas"),r=o.width,l=o.height;r>l?r>a&&(l*=a/r,r=a):l>a&&(r*=a/l,l=a),i.width=r,i.height=l,i.getContext("2d").drawImage(o,0,0,r,l),s.output(i,t,n)},o.src=e},output:function(e,a,t){switch(a){case"file":e.toBlob((function(e){t(e)}),"image/jpeg",.8);break;case"dataURL":t(e.toDataURL("image/jpeg",.8))}}},e}(),$(document).ready((function(){$("select.sbp_bank_id").chosen({disable_search_threshold:10,no_results_text:"Ничего не найдено!",placeholder_text_single:"Выберите из списка"})})),$(document).on("click",".sbp_like_main_phone",(function(e){e.preventDefault();var a=$("input[name=phone_mobile]");""==a.val()||a.hasClass("notValid")||($("input[name=sbp_phone]").val(a.val()),addClassValid($("input[name=sbp_phone]"),!0))})),$(document).on("change","select[name=sbp_bank_id_a]",(function(e){var a=$(this).val(),t=$(this).attr("data-form"),n=$(this).find("option:selected").text();a&&""!=a&&$(t+" input[name=sbp_bank_text_a]").val(n)})),$(document).on("change","#main_form input[name=sbp_available_checkbox]",(function(e){$(this).prop("checked")?$("#main_form input[name=sbp_available]").val(0):$("#main_form input[name=sbp_available]").val(1),$("#main_form input[name=sbp_available]").trigger("change")})),$(document).on("change","#main_form input[name=sbp_available]",(function(){1!=$(this).val()?($("#main_form input[name=sbp_phone]").addClass("disabled").attr("disabled",!0).val("").removeClass("notValid").removeClass("valid").removeAttr("data-need"),$("#main_form select[name=sbp_bank_id_a] option:first").attr("selected","selected"),$("#main_form select[name=sbp_bank_id_a]").addClass("disabled").attr("disabled",!0).trigger("chosen:updated"),$("#main_form input[name=sbp_bank_text_a]").val(""),$("#main_form .sbp_like_main_phone").hide()):($("#main_form input[name=sbp_phone]").removeClass("disabled").attr("disabled",!1).attr("data-need",1),$("#main_form select[name=sbp_bank_id_a] option:first").removeAttr("selected","selected"),$("#main_form select[name=sbp_bank_id_a]").removeClass("disabled").attr("disabled",!1).trigger("chosen:updated"),$("#main_form .sbp_like_main_phone").show())})),$(document).on("change","input[name=sbp_payout_status_checkbox]",(function(e){var a=$(this).prop("checked"),t=$(this).attr("data-form");$("#second_form input[name=app_id]").val();a?($("input[name=clearing_status_checkbox]").prop("checked",!1).trigger("change"),$("input[name=bank_card_checkbox]").prop("checked",!1).trigger("change"),$(t+" input[name=sbp_available]").val(1),$(t+" input[name=sbp_payout_status]").val(1),$("#step-2-sbp-fields").removeClass("d-none"),$("#step-2-bank_card-fields").addClass("d-none"),$("#r_schet").addClass("d-none"),$(t+" input[name=sbp_phone]").attr("data-need",1),$("#bank_card_number").removeAttr("data-need")):($(t+" input[name=sbp_payout_status]").val(0),$("#second_form input[name=sbp_phone]").removeAttr("data-need").removeClass("valid notValid"),$("#step-2-sbp-fields").addClass("d-none"))})),$(document).on("change","input[name=clearing_status_checkbox]",(function(e){var a=$(this).prop("checked"),t=$(this).attr("data-form");a?($("input[name=sbp_payout_status_checkbox]").prop("checked",!1).trigger("change"),$("input[name=bank_card_checkbox]").prop("checked",!1).trigger("change"),$(t+" input[name=clearing_status]").val(1),$("#r_schet").removeClass("d-none"),$("#step-2-sbp-fields").addClass("d-none"),$("#step-2-bank_card-fields").addClass("d-none"),$("#r_schet input").attr("data-need",1),$("input[name=clearing_status]").removeAttr("data-need"),$("#bank_card_number").removeAttr("data-need"),$("input[name=clearing_payee_bankbik],input[name=clearing_payee_personalacc],#r_schet input[name=inn]").trigger("change"),""!=$("#r_schet input[name=clearing_payee_name]").val()&&addClassValid($("#r_schet input[name=clearing_payee_name]"),!0)):($(t+" input[name=clearing_status]").val(0),$("#r_schet").addClass("d-none"),$("#r_schet input").removeAttr("data-need").removeClass("valid notValid"))})),$(document).on("change","input[name=bank_card_checkbox]",(function(e){var a=$(this).prop("checked"),t=$(this).attr("data-form");a?($("input[name=sbp_payout_status_checkbox]").prop("checked",!1).trigger("change"),$("input[name=clearing_status_checkbox]").prop("checked",!1).trigger("change"),$(t+" input[name=bank_card_payout_status]").val(1),$("#step-2-bank_card-fields").removeClass("d-none"),$("#r_schet").addClass("d-none"),$("#step-2-sbp-fields").addClass("d-none"),$("#bank_card_number").attr("data-need",1),$("input[name=clearing_status]").removeAttr("data-need"),$(t+" input[name=sbp_phone]").attr("data-need",0),""!=$("#r_schet input[name=clearing_payee_name]").val()&&addClassValid($("#r_schet input[name=clearing_payee_name]"),!0)):($(t+" input[name=bank_card_payout_status]").val(0),$("#step-2-bank_card-fields").addClass("d-none"),$("#bank_card_number").removeAttr("data-need").removeClass("valid notValid").val(""))})),$(document).on("click",".get-sbp-payout",(function(e){e.preventDefault();var a=$(this).attr("data-phone"),t=$(this).attr("href");$(this).hasClass("disabled")||($("#sbp-payout-modal").slideDown(200),$("body").addClass("modal-open"),$("#sbp-payout-form input[name=id_app]").val(t),$("#sbp-payout-form input[name=sbp_phone]").val(a))})),$(document).on("click",".accept-sbp-agreement",(function(e){var a=$("input[name=uuid]").val(),t=$("#sbp-payout-form input[name=sbp_phone]").val();""!=a&&$.ajax({type:"GET",url:api+"/api/v1/SbpPay?"+(new Date).getTime(),data:{uuid:a},beforeSend:function(){$(".sbp-payout-agreement-block").prepend('<div class="locker">'+preloader+"</div>")},success:function(e){$(".sbp-payout-agreement-block .locker").remove();var a="";e.error_code&&(a="Код ошибки: "+e.error_code),console.log(e),1==e.error?showPopup({text:"Возникла ошибка. Описание ошибки: "+e.error_msg+"<br>"+a}):1==e.success&&($("#sbp-payout-form .client-phone").text(t),$(".sbp-payout-agreement-block").hide(),$(".sbp-payout-main-block").slideDown(200))},error:function(e,a){return $(".sbp-payout-agreement-block .locker").remove(),showPopup({text:"Возникла ошибка: "+e.responseText}),!1}})})),$(document).on("input","input[name=sbp_pay]",(function(){4==$(this).val().length?$(".sbp-payout-button").removeClass("disabled").removeAttr("disabled"):$(".sbp-payout-button").addClass("disabled").attr("disabled",!0)})),$(document).on("click",".sbp-payout-button",(function(e){e.preventDefault(),checkSBPCodes($("#sbp-payout-form"))}));var jstime="start";function MQremove(){$('#programm option[value="МаниКло кальк-р"]').attr("hidden",!0).prop("disabled",!0)}function MQadd(){$('#programm option[value="МаниКло кальк-р"]').removeAttr("hidden").prop("disabled",!1)}function sendUpdate(e){var a=JSON.stringify(e),t=$("input[name=uuid]").val();$.ajax({type:"POST",url:api+"/api/v1/updateOrder?"+(new Date).getTime(),data:{uuid:t,data:a},beforeSend:function(){$("#updateOrder").prepend('<div class="locker">'+preloader+"</div>")},success:function(e){var a="";1==e.success&&location.reload(),e.error_code&&(a="Код ошибки: "+e.error_code,showPopup({text:"Возникла ошибка. Описание ошибки: "+e.error_msg+"<br>"+a}),$(".locker").remove()),console.log(e)},error:function(e,a){return showPopup({text:"Возникла ошибка: "+e.responseText}),!1}})}function getLimit(e,a,t,n){$.ajax({type:"POST",url:"user/getLimits?"+(new Date).getTime(),data:{id:e},beforeSend:function(){clearFieldsSetp2(),$("#second_form").prepend('<div class="locker">'+preloader+"</div>")},success:function(s){$(".locker").remove();var o="";(s=jQuery.parseJSON(s)).error_code&&(o="Код ошибки: "+s.error_code),console.log(s),1==s.sucsess?($("input[name=current_limit]").val(s.limit),$(".current_limit span").text(s.limit.replace(/^\s*(\d+)(\d{3})\s*([а-я\.]+)?\s*$/,"$1 $2 $3")),$("input[name=app_id]").val(e),$(".logt-block").hide(),$("input[name=sbp_payout_status_checkbox], input[name=clearing_status_checkbox]").prop("checked",!1).trigger("change"),$("#r_schet input[name=clearing_payee_name]").val(a).addClass("valid"),console.log(t),1==t||"true"==t?($("#second-modal").removeClass("sbp_forbidden"),$("#sbp_payout_status").prop("checked",!0).trigger("change")):($("#second-modal").addClass("sbp_forbidden"),$("#sbp_payout_status").prop("checked",!1).trigger("change")),n?$(".bank_card_block").show():$(".bank_card_block").hide(),$("#second-modal").slideDown(200),$("body").addClass("modal-open")):showPopup({text:"Возникла ошибка. Описание ошибки: "+s.error_msg+"<br>"+o})},error:function(e,a){return showPopup({text:"Возникла ошибка: "+e.responseText}),!1}})}function clearFieldsSetp2(){$("#second-modal").removeClass("sbp_forbidden"),$("#sbp_payout_status").prop("checked",!1),$("#second_form input[name=sbp_phone]").val("").removeAttr("data-need").removeClass("valid notValid"),$("#second_form input[name=sbp_bank_text_a]").val(""),$("#second_form input[name=sbp_available]").val(0),$("#second_form input[name=sbp_payout_status]").val(0),$("#second_form select[name=sbp_bank_id_a]").val("").trigger("chosen:updated"),$("#step-2-sbp-fields").addClass("d-none"),$("#r_schet input").val("")}function sendData2(e){$.ajax({type:"POST",url:"main/sendJsonEtap2?"+(new Date).getTime(),data:e,beforeSend:function(){$("#second_form").prepend('<div class="locker">'+preloader+"</div>")},success:function(e){var a="";(e=jQuery.parseJSON(e)).error_code&&(a="Код ошибки: "+e.error_code),console.log(e),1==e.success?showPopup({title:"",text:"Заявка успешно создана.",links:[{link_text:"OK",link_class:"reloadapp",link:"/"}]}):(showPopup({text:"Возникла ошибка. Описание ошибки: "+e.error_msg+"<br>"+a}),$(".locker").remove())},error:function(e,a){return showPopup({text:"Возникла ошибка: "+e.responseText}),!1}})}function sendData(e){var a=$("#csrf").val(),t=JSON.stringify(e);$.ajax({type:"POST",url:api+"/api/v2/store?"+(new Date).getTime(),data:{_token:a,data:t},beforeSend:function(){$("#main_form").prepend('<div class="locker">'+preloader+"</div>")},success:function(e){var a="";e.error_code&&(a="Код ошибки: "+e.error_code),console.log(e),e.uuid?($(".applist-container").empty(),$(".applist-container").append('<div class="container"><div class="row"><div class="col-12"><div class="sub-title">Формируем документы для подписания...</div></div></div></div>'),askAppStatus(e.uuid)):(showPopup({text:"Возникла ошибка. Описание ошибки: "+e.error_msg+"<br>"+a}),$(".locker").remove())},error:function(e,a){return showPopup({text:"Возникла ошибка: "+e.responseText}),!1}})}function askAppStatus(e){var a=setInterval((function(){$.ajax({type:"GET",url:api+"/api/v1/getStatus?"+(new Date).getTime(),data:{uuid:e},beforeSend:function(){},success:function(t){if(t.error_code&&"Код ошибки: "+t.error_code,console.log(t),3==t.code){clearInterval(a),console.log();var n=t.data;console.log(n),$("#asp1 input[name=id_app]").val(e),$("#asp1 .docs-lines").html(buildListAsp(n,e)),$(".asp1").slideDown(200),$("#asp1-modal .goback").show(),$(".sign-type-select").slideUp(200),$("#asp1-modal").slideDown(200),$("body").addClass("modal-open")}},error:function(e,a){return showPopup({text:"Возникла ошибка: "+e.responseText}),!1}})}),3e3)}function signDoc(e,a){$.ajax({type:"POST",url:"main/writeDock?"+(new Date).getTime(),data:{id:e,type:a},beforeSend:function(){},success:function(e){var a="";(e=jQuery.parseJSON(e)).error_code&&(a="Код ошибки: "+e.error_code),console.log(e),1==e.sucess?showPopup({text:"Спасибо, документы успешно подписаны",links:[{link_text:"OK",link_class:"reloadapp",link:"/"}]}):showPopup({text:"Возникла ошибка. Описание ошибки: "+e.error_msg+"<br>"+a})},error:function(e,a){return showPopup({text:"Возникла ошибка: "+e.responseText}),!1}})}function checkAuth(e){}function lgotniyCalc(e,a,t){var n=[],s=0,o=0;if(console.log(e),e.includes("Льготный")){switch(e){case"Льготный 3 мес":o=/\d+/.exec(e),o=Number(o[0]),s=.04,n[0]=.0456,n[1]=.0076,n[2]=.0076,n[3]=.0554,n[4]=.0256,n[5]=.0235,n[6]=.0226,n[7]=.0204,n[8]=.0215,n[9]=.0195,n[10]=.0183,n[11]=.0167;break;case"Льготный 5 мес":o=/\d+/.exec(e),o=Number(o[0]),s=.07,n[0]=.0476,n[1]=.016,n[2]=.016,n[3]=.016,n[4]=.016,n[5]=.0539,n[6]=.0226,n[7]=.0204,n[8]=.0215,n[9]=.0195,n[10]=.0183,n[11]=.0167;break;case"Льготный Супер 5":o=/\d+/.exec(e),o=Number(o[0]),s=.1,n[0]=.0342,n[1]=.0315,n[2]=.0196,n[3]=.0145,n[4]=.0114,n[5]=.0416,n[6]=.0357,n[7]=.0317,n[8]=.026,n[9]=.0186,n[10]=.0132,n[11]=.0064;break;case"Льготный Супер 6":o=/\d+/.exec(e),o=Number(o[0]),s=.1,n[0]=.0382,n[1]=.0338,n[2]=.025,n[3]=.0198,n[4]=.0141,n[5]=.0121,n[6]=.0395,n[7]=.0349,n[8]=.0291,n[9]=.0188,n[10]=.0132,n[11]=.0061;break;case"Льготный Супер 7":o=/\d+/.exec(e),o=Number(o[0]),s=.1,n[0]=.0425,n[1]=.0397,n[2]=.0266,n[3]=.0201,n[4]=.0173,n[5]=.0119,n[6]=.0087,n[7]=.0393,n[8]=.0324,n[9]=.0226,n[10]=.0162,n[11]=.0074;break;case"Льготный Супер 8":o=/\d+/.exec(e),o=Number(o[0]),s=.1,n[0]=.0399,n[1]=.0357,n[2]=.0264,n[3]=.0245,n[4]=.0174,n[5]=.0155,n[6]=.0089,n[7]=.0071,n[8]=.0433,n[9]=.0323,n[10]=.023,n[11]=.0108;break;case"Льготный Платинум 6":o=/\d+/.exec(e),o=Number(o[0]),s=.1,0==t&&(n[0]=.0255,n[1]=.023,n[2]=.0185,n[3]=.0179,n[4]=.0147,n[5]=.0116,n[6]=.1028,n[7]=.0874,n[8]=.0691,n[9]=.0448,n[10]=.0332,n[11]=.0157),10==t&&(n[0]=.0382,n[1]=.0233,n[2]=.0188,n[3]=.0182,n[4]=.0146,n[5]=.012,n[6]=.1066,n[7]=.0898,n[8]=.0587,n[9]=.0394,n[10]=.0339,n[11]=.0107),20==t&&(n[0]=.0535,n[1]=.0237,n[2]=.0192,n[3]=.0186,n[4]=.0155,n[5]=.0124,n[6]=.0928,n[7]=.0875,n[8]=.059,n[9]=.0397,n[10]=.0343,n[11]=.008);break;case"Льготный Платинум 10":o=/\d+/.exec(e),o=Number(o[0]),s=.1418,summa_zaim>29999?(0==t&&(n[0]=.0255,n[1]=.0239,n[2]=.0201,n[3]=.0205,n[4]=.0181,n[5]=.0158,n[6]=.0131,n[7]=.0114,n[8]=.0096,n[9]=.0073,n[10]=.082,n[11]=.0774,n[12]=.0766,n[13]=.0729,n[14]=.0515,n[15]=.0368,n[16]=.0253,n[17]=.0128),10==t&&(n[0]=.0382,n[1]=.0282,n[2]=.0204,n[3]=.0209,n[4]=.0185,n[5]=.0174,n[6]=.014,n[7]=.0123,n[8]=.0101,n[9]=.0069,n[10]=.0835,n[11]=.0769,n[12]=.0762,n[13]=.0727,n[14]=.0482,n[15]=.0308,n[16]=.0184,n[17]=.007),20==t&&(n[0]=.051,n[1]=.0392,n[2]=.021,n[3]=.0215,n[4]=.0192,n[5]=.018,n[6]=.0146,n[7]=.0129,n[8]=.0103,n[9]=.0077,n[10]=.0804,n[11]=.0731,n[12]=.0718,n[13]=.0677,n[14]=.0505,n[15]=.0229,n[16]=.0131,n[17]=.0057)):(0==t&&(n[0]=.0255,n[1]=.0239,n[2]=.0201,n[3]=.0206,n[4]=.0183,n[5]=.016,n[6]=.0129,n[7]=.0112,n[8]=.0096,n[9]=.0074,n[10]=.0848,n[11]=.079,n[12]=.0702,n[13]=.0553,n[14]=.0413,n[15]=.0361,n[16]=.0248,n[17]=.0122),10==t&&(n[0]=.0382,n[1]=.0283,n[2]=.0205,n[3]=.021,n[4]=.0187,n[5]=.0176,n[6]=.0133,n[7]=.0116,n[8]=.01,n[9]=.0078,n[10]=.0857,n[11]=.0774,n[12]=.0723,n[13]=.054,n[14]=.0393,n[15]=.03,n[16]=.0182,n[17]=.0053),20==t&&(n[0]=.051,n[1]=.0393,n[2]=.0211,n[3]=.0217,n[4]=.0193,n[5]=.0183,n[6]=.0138,n[7]=.0122,n[8]=.0106,n[9]=.0083,n[10]=.0847,n[11]=.0757,n[12]=.07,n[13]=.0502,n[14]=.0338,n[15]=.0227,n[16]=.013,n[17]=.0035));break;case"Льготный с 4 равными платежами":s=.04,o=3,n[0]=.0476,n[1]=.0063,n[2]=.0025,n[3]=.1176,n[4]=.1076,n[5]=.0768,n[6]=.0363,n[7]=.0278,n[8]=.023,n[9]=.0061,n[10]=.003,n[11]=.001;break;case"Льготный с 6 равными платежами":s=.07,o=5,n[0]=.0651,n[1]=.0135,n[2]=.0051,n[3]=.0048,n[4]=.0033,n[5]=.1245,n[6]=.1123,n[7]=.109,n[8]=.0712,n[9]=.0067,n[10]=.004,n[11]=.0018;break;default:s=.04,o=/\d+/.exec(e),o=Number(o[0]),n[0]=.0213,n[1]=.0107,n[2]=.0092,n[3]=.0076,n[4]=.006,n[5]=.006,n[6]=.0107,n[7]=.0408,n[8]=.0215,n[9]=.0195,n[10]=.0183,n[11]=.0167}var r=a-t-a*s,l=0;for(i=0;i<n.length;i++)l+=Math.round(r*n[i]);var p=$("#monthly_installment").val();(e.includes("Льготный с 4 равными платежами")||e.includes("Льготный с 6 равными платежами"))&&(console.log(r,o),p=Math.round((a-t)/o));var c=new Date,d={total:a-t,monthly:p,months:o,final:a-t-p*(o-1),date:new Date(c.setMonth(c.getMonth()+o)).toLocaleDateString()};console.log((r+l)/12),$(".logt-date span").text(d.date),$(".monthly-payment span").text(d.monthly+" руб."),$(".final-payment span").text(d.final+" руб."),$(".total-payment span").text(d.total+" руб."),$(".logt-block").show()}else $(".logt-block").hide();fillTempForm(e,$("select[name=months]").val(),a,t)}function fillTempForm(e,a,t,n){var s=$("input[name=login]").val(),o=$("input[name=overpayment]").val(),i=$("input[name=summa_dogovor]").val(),r=$("input[name=summa_zaim]").val(),l=$("#monthly_installment").val();$("#temp_form").empty(),$("#temp_form").append(createHiddenInput("programm",e)),$("#temp_form").append(createHiddenInput("months",a)),$("#temp_form").append(createHiddenInput("summ",t)),$("#temp_form").append(createHiddenInput("avans_to_partner",n)),$("#temp_form").append(createHiddenInput("monthly_installment",l)),$("#temp_form").append(createHiddenInput("login",s)),$("#temp_form").append(createHiddenInput("overpayment",o)),$("#temp_form").append(createHiddenInput("summa_dogovor",i)),$("#temp_form").append(createHiddenInput("summa_zaim",r)),$("#temp_form").attr("action","/main/printPdfLgot")}function createHiddenInput(e,a){return'<input type="hidden" name="'+e+'" value="'+a+'">'}function cancelAppInit(e){$.ajax({type:"POST",url:"main/cancellMess?"+(new Date).getTime(),data:{id_app:e},beforeSend:function(){$("#app-docks-modal").slideUp(200),$("body").removeClass("modal-open"),setTimeout((function(){$("body").addClass("modal-open"),$("#cancelApp-modal").slideDown(200),$("#cancelApp-modal input[name=id_app]").val(e),$("#cancelApp-modal .title").after('<div class="loading" data-loader="circle-side"></div>')}),200)},success:function(a){if(1==(a=jQuery.parseJSON(a)).success||"true"==a.success){$("#cancelApp-modal .loading").remove();$("#cancelApp-modal .docs-lines").html(buildListAsp([{type:"cancelApp"}],e))}else console.log(a),showPopup({text:"Возникла ошибка: "+a.error_msg})},error:function(e,a){return showPopup({text:"Возникла ошибка: "+e.responseText}),!1}})}function cancelAppConfirm(e){$.ajax({type:"POST",url:"main/cancellationApp?"+(new Date).getTime(),data:{id_app:e},beforeSend:function(){},success:function(e){1==(e=jQuery.parseJSON(e)).succes?showPopup({title:"",text:"Договор успешно аннулирован.",links:[{link_text:"OK",link_class:"reloadapp",link:"/"}]}):(console.log(e),showPopup({text:"Возникла ошибка: "+e.error_msg}))},error:function(e,a){return showPopup({text:"Возникла ошибка: "+e.responseText}),!1}})}function getApp(e){$.ajax({type:"POST",url:api+"/api/v1/checkStatus?"+(new Date).getTime(),data:{uuid:e},beforeSend:function(){$(".applist-container").empty(),$(".applist-container").prepend(preloader)},success:function(e){if(console.log(e),$(".preloader").remove(),data=e.data,0!=data.length){var a="";$.each(data,(function(e,t){console.log(e,t);var n,s="",o="";n=0!=t.contract;var i=t.Ref?t.Ref:0,r=t.front_status,l=(t.bki,t.dogovor,t.DescriptionTemplate?t.DescriptionTemplate:""),p=t.approved_limit?t.approved_limit:"",c=p.slice(0,-3),d="",u=""!=t.phone&&null!=t.phone?t.phone:"клиента",m=""!=t.sbp_phone&&null!=t.sbp_phone?t.sbp_phone:"клиента";console.log(t);var _=t.date_created?t.date_created.split(" ")[0]:"",h=0,$=!!t.sbp_payout_status,f=String(t.fio),v=""==f.replace(/(<([^>]+)>)/gi,"").trim()?"Недопустимое значение ФИО":f.replace(/(<([^>]+)>)/gi,""),g="",k="",b=1==t.is_allowed_pefix;switch(t.type_write){case"0":h=0;break;case"1":h="договор подписан АСП";break;case"2":h="договор подписан вручную";break;case"3":h="договор аннулирован"}try{r=r.replace("{{limit}}",c)}catch(e){}107==t.status&&(s='<a href="'+t.anket_id+'" data-phone="'+u+'" data-stage="1" class="sign-app">Подписать</a>'),104!=t.status&&108!=t.status||(s='<a href="'+t.anket_id+'" data-sbp_allowed="'+b+'" class="go-step-2">Оформить</a>'),108==t.status&&isMoneyQlo(b64_to_utf8(l))&&(g="-MQ- ",k="mq"),204==t.status&&0!=i&&(n&&(r="подпишите договор",s='<a href="'+t.anket_id+'" data-phone="'+u+'" data-stage="2" class="sign-app">Подписать</a>'),d="not-signed",o=$?b?'<a href="'+t.anket_id+'" title="Доступно после подписания договора" data-phone="'+m+'" data-stage="2" class="get-sbp-payout disabled">Клиенту СБП</a>':'<a href="'+t.anket_id+'" title="Доступно после подписания договора" data-phone="'+m+'" data-stage="2" class="get-sbp-payout exclam disabled">Клиенту СБП</a>':'<a href="'+t.anket_id+'" title="Доступно после подписания договора" data-phone="'+u+'" data-stage="2" class="get-akt disabled">На оплату</a>'),207==t.status&&(d="signed",r="договор подписан",0!=h&&(r=h),o="1"==t.type_write&&$&&n?b?'<a href="'+t.anket_id+'" title="Доступно после подписания договора" data-phone="'+m+'" data-stage="2" class="get-sbp-payout">Клиенту СБП</a>':'<a href="'+t.anket_id+'" title="Доступно после подписания договора" data-phone="'+m+'" data-stage="2" class="get-sbp-payout exclam">Клиенту СБП</a>':0==$&&1==n?'<a href="'+t.anket_id+'" data-phone="'+u+'" data-stage="2" class="get-akt">На оплату</a>':$&&0==n?b?'<a href="'+t.anket_id+'" title="Доступно после подписания договора" data-phone="'+m+'" data-stage="2" class="get-sbp-payout disabled">Клиенту СБП</a>':'<a href="'+t.anket_id+'" title="Доступно после подписания договора" data-phone="'+m+'" data-stage="2" class="get-sbp-payout exclam disabled">Клиенту СБП</a>':'<a href="'+t.anket_id+'" title="Доступно после подписания договора" data-phone="'+u+'" data-stage="2" class="get-akt disabled">На оплату</a>'),206==t.status&&(s='<a href="'+t.anket_id+'" data-sbp_allowed="'+b+'" data-phone="'+u+'" class="go-step-2">Уточнить</a>'),209==t.status&&(s='<a href="'+t.anket_id+'" data-credit_card="true" data-sbp_allowed="'+b+'" data-phone="'+u+'" class="go-step-2">Уточнить</a>'),303==t.status&&(s=""),a+='<div class="app-info '+d+'" id="'+t.anket_id+'">\n                            <div class="app-left-block"><div class="app-string">\n                                <div class="app-number">'+t.anket_id+'</div><div class="dot"></div>\n                                <div class="app-date">'+t.date_created+'</div>\n                            </div>\n                            <div class="client-fio">'+v+'</div></div>\n                            <div class="app-right-block">\n                            <div data-ref="'+i+'" data-appdate="'+_+'" data-comment="'+l+'" data-statusnum="'+t.status+'" data-limit="'+p+'" data-id="'+t.anket_id+'" class="'+k+" app-status status-"+t.status+'">'+g+r+'</div>\n                            <div class="app-button">'+s+o+"</div>\n                            </div></div>"})),$(".applist-container").append(a)}else $(".applist-container").html("<span>Список заявок пуст.</span>")},error:function(e,a){return showPopup({text:"Возникла ошибка: "+e.responseText}),!1}})}function b64_to_utf8(e){try{return decodeURIComponent(escape(window.atob(e)))}catch(a){return e}}function isMoneyQlo(e){return e.indexOf("Маникло")>=0}$(document).ready((function(){$(".date-type").mask("99.99.9999"),$("select[name=spending_aim]").change((function(){"Потребительские нужды"!=$(this).val()&&($("#spending_aim_else").modal("show"),$("input[name=spending_aim_else]").val($(this).val()))})),$("#confirm_spending_aim").click((function(){var e=$("input[name=spending_aim_else]").val().trim();""!=e&&$("select[name=spending_aim] option:selected").val(e).text("Иное("+e+")")})),$("#main_form").submit((function(e){if(e.preventDefault(),fullValidationStep1()){$("#main_form .sbp-block input").prop("disabled",!1),$("#main_form .sbp-block select").prop("disabled",!1);var a=$("#main_form").serializeArray(),t={};$.each(a,(function(){if(this.name.includes("[]")){var e=this.name.replace("[]","");console.log(t.pureName),void 0!==t.pureName&&t.pureName.push(this.value),t[e]=[this.value]||""}else t[this.name]=this.value||""})),sendData(t)}else $("#main-modal").animate({scrollTop:0},300)})),$("#second_form").submit((function(e){e.preventDefault();var a=$(this).serialize();fullValidationStep2()?sendData2(a):$("#second-modal").animate({scrollTop:0},300)})),$(".new-app-button").click((function(e){e.preventDefault(),$("#main-modal").slideDown(200),$("body").addClass("modal-open")})),$("#main-modal .closer").click((function(e){e.preventDefault(),$("#main-modal").slideUp(200),$("body").removeClass("modal-open")})),$("#second-modal .closer").click((function(e){e.preventDefault(),$("#second-modal").removeClass("calc-mode").slideUp(200),$("body").removeClass("modal-open"),MQremove(),resetForm2()})),$("#app-docks-modal .closer").click((function(e){e.preventDefault(),$("#app-docks-modal").slideUp(200),$("body").removeClass("modal-open")})),$("#asp1-modal .closer").click((function(e){e.preventDefault(),$("#asp1-modal").slideUp(200),$("body").removeClass("modal-open")})),$("#asp2-modal .closer").click((function(e){e.preventDefault(),$("#asp2-modal").slideUp(200),$("body").removeClass("modal-open")})),$(".sms-modal .closer").click((function(e){e.preventDefault(),$(".sms-modal").slideUp(200),$("body").removeClass("modal-open")})),$("#sbp-payout-modal .closer").click((function(e){e.preventDefault(),$("#sbp-payout-modal").slideUp(200),$("body").removeClass("modal-open"),$(".sbp-payout-agreement-block").show(),$(".sbp-payout-main-block").hide(),$("#sbp-payout-form input").val("")})),$(".calc-button").click((function(){$(".logt-block").hide(),$("#second-modal").addClass("calc-mode").slideDown(200),MQadd(),$("body").addClass("modal-open")})),$(".menu-icon, .main-menu li a.show-spravka").click((function(){$(".main-menu").slideToggle(200)})),setInterval((function(){checkAuth()}),6e4),setInterval((function(){checkAuth(!0)}),3e5)})),$(document).on("click",".go-step-2",(function(e){e.preventDefault(),$("#payment_refine").modal("show")})),$(document).on("submit","#updateOrder",(function(){var e=$("#updateOrder").serializeArray(),a={};$.each(e,(function(){a[this.name]=this.value||""})),sendUpdate(a)})),$(document).on("click","#popup .closer, #popup .closepopup",(function(e){e.preventDefault(),closePopup()})),$(document).on("change","[name=place_holder]",(function(){"Y"==$(this).val()?$(".place_holder_position").show():($(".place_holder_position").hide(),$("[name=place_holder_position]").removeClass("valid").val(""))})),$(document).on("click",".download-lgot-pdf",(function(e){e.preventDefault(),$("#temp_form").submit()})),$(document).on("click",".app-status",(function(e){e.preventDefault(),$("#app-docks-modal .annul-block").html("");var a=$(this).attr("data-id"),t=$(this).attr("data-ref"),n=$(this).text(),s=$(this).attr("data-comment");s=b64_to_utf8(s);var o=$(this).attr("data-limit"),i=$(this).attr("data-statusnum"),r=$(this).attr("data-appdate"),l=$("#today").val();208!=i&&($("#app-docks-modal .status-info span").text(n),$("#app-docks-modal .limit-info span").text(o),$("#app-docks-modal .comment-info span").html(s),$("#app-docks-modal .get-pdf").attr("href",a),0!=t&&$("#app-docks-modal .doc-string .dogovor").html('<a href="'+t+'" class="get-dogovor">Договор</a>'),204==i&&r==l?$("#app-docks-modal .annul-block").html('<p>Клиент отказался от подписания договора займа? Нажмите <a data-status="'+i+'" class="annul" href="'+a+'">аннулировать договор</a></p>'):207==i&&$("#app-docks-modal .annul-block").html("<p>Для аннуляции подписанного договора направьте заявление в операционный отдел</p>"),$("#app-docks-modal").slideDown(200),$("body").addClass("modal-open"))})),$(document).on("click",".pay-app",(function(e){e.preventDefault()})),$(document).on("click",".annul",(function(e){e.preventDefault();var a="После аннуляции, подписание договора будет не доступно. Вы уверены, что хотите аннулировать договор?",t="annul_app";if("207"===$(this).attr("data-status"))a="После аннуляции, подписание договора будет не доступно. Вы уверены, что хотите аннулировать договор?",t="annul_app_207";else a="После аннуляции, подписание договора будет не доступно. Вы уверены, что хотите аннулировать договор?",t="annul_app";showPopup({title:"Внимание",text:a,links:[{link_text:"Нет",link_class:"closepopup",link:"#"},{link_text:"Да",link_class:t,link:$(this).attr("href")}]})})),$(document).on("click",".annul_app",(function(e){e.preventDefault(),closePopup(),cancelAppConfirm($(this).attr("href"))})),$(document).on("click",".annul_app_207",(function(e){e.preventDefault(),closePopup(),cancelAppInit($(this).attr("href"))})),$(document).on("submit","#cancelApp",(function(e){e.preventDefault(),checkAspCodes($("#cancelApp"),!0)})),$(document).on("click",".sign-app",(function(e){e.preventDefault(),showAspModal($("input[name=uuid]").val(),$(this).attr("data-stage"),$(this).attr("data-phone"))}));